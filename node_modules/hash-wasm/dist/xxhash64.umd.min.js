/*!
 * hash-wasm (https://www.npmjs.com/package/hash-wasm)
 * (c) Dani Biro
 * @license MIT
 */

!function(A,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((A="undefined"!=typeof globalThis?globalThis:A||self).hashwasm=A.hashwasm||{})}(this,(function(A){"use strict";function e(A,e,t,n){return new(t||(t=Promise))((function(r,i){function o(A){try{f(n.next(A))}catch(A){i(A)}}function s(A){try{f(n.throw(A))}catch(A){i(A)}}function f(A){var e;A.done?r(A.value):(e=A.value,e instanceof t?e:new t((function(A){A(e)}))).then(o,s)}f((n=n.apply(A,e||[])).next())}))}class t{constructor(){this.mutex=Promise.resolve()}lock(){let A=()=>{};return this.mutex=this.mutex.then(()=>new Promise(A)),new Promise(e=>{A=e})}dispatch(A){return e(this,void 0,void 0,(function*(){const e=yield this.lock();try{return yield Promise.resolve(A())}finally{e()}}))}}var n;const r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,i=null!==(n=r.Buffer)&&void 0!==n?n:null,o=r.TextEncoder?new r.TextEncoder:null,s="a".charCodeAt(0)-10,f="0".charCodeAt(0);function C(A,e,t){let n=0;for(let r=0;r<t;r++){let t=e[r]>>>4;A[n++]=t>9?t+s:t+f,t=15&e[r],A[n++]=t>9?t+s:t+f}return String.fromCharCode.apply(null,A)}const Q=null!==i?A=>{if("string"==typeof A){const e=i.from(A,"utf8");return new Uint8Array(e.buffer,e.byteOffset,e.length)}if(i.isBuffer(A))return new Uint8Array(A.buffer,A.byteOffset,A.length);if(ArrayBuffer.isView(A))return new Uint8Array(A.buffer,A.byteOffset,A.byteLength);throw new Error("Invalid data type!")}:A=>{if("string"==typeof A)return o.encode(A);if(ArrayBuffer.isView(A))return new Uint8Array(A.buffer,A.byteOffset,A.byteLength);throw new Error("Invalid data type!")},I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=new Uint8Array(256);for(let A=0;A<I.length;A++)a[I.charCodeAt(A)]=A;function l(A){const e=function(A){let e=Math.floor(.75*A.length);const t=A.length;return"="===A[t-1]&&(e-=1,"="===A[t-2]&&(e-=1)),e}(A),t=A.length,n=new Uint8Array(e);let r=0;for(let e=0;e<t;e+=4){const t=a[A.charCodeAt(e)],i=a[A.charCodeAt(e+1)],o=a[A.charCodeAt(e+2)],s=a[A.charCodeAt(e+3)];n[r]=t<<2|i>>4,r+=1,n[r]=(15&i)<<4|o>>2,r+=1,n[r]=(3&o)<<6|63&s,r+=1}return n}const g=16384,u=new t,h=new Map;function c(A,t){return e(this,void 0,void 0,(function*(){let n=null,r=null,i=!1;if("undefined"==typeof WebAssembly)throw new Error("WebAssembly is not supported in this environment!");const o=u.dispatch(()=>e(this,void 0,void 0,(function*(){if(!h.has(A.name)){const e=l(A.data),t=WebAssembly.compile(e);h.set(A.name,t)}const e=yield h.get(A.name);n=yield WebAssembly.instantiate(e,{})}))),s=(A=null)=>{i=!0,n.exports.Hash_Init(A)},f=A=>{if(!i)throw new Error("update() called before init()");(A=>{let e=0;for(;e<A.length;){const t=A.subarray(e,e+g);e+=t.length,r.set(t),n.exports.Hash_Update(t.length)}})(Q(A))},I=new Uint8Array(2*t),a=(A,e=null)=>{if(!i)throw new Error("digest() called before init()");return i=!1,n.exports.Hash_Final(e),"binary"===A?r.slice(0,t):C(I,r,t)},c=A=>"string"==typeof A?A.length<4096:A.byteLength<g;let w=c;switch(A.name){case"argon2":case"scrypt":w=()=>!0;break;case"blake2b":case"blake2s":w=(A,e)=>e<=512&&c(A);break;case"blake3":w=(A,e)=>0===e&&c(A);break;case"xxhash64":w=()=>!1}return yield(()=>e(this,void 0,void 0,(function*(){n||(yield o);const A=n.exports.Hash_GetBuffer(),e=n.exports.memory.buffer;r=new Uint8Array(e,A,g)})))(),{getMemory:()=>r,writeMemory:(A,e=0)=>{r.set(A,e)},getExports:()=>n.exports,setMemorySize:A=>{n.exports.Hash_SetMemorySize(A);const e=n.exports.Hash_GetBuffer(),t=n.exports.memory.buffer;r=new Uint8Array(t,e,A)},init:s,update:f,digest:a,calculate:(A,e=null,i=null)=>{if(!w(A,e))return s(e),f(A),a("hex",i);const o=Q(A);return r.set(o),n.exports.Hash_Calculate(o.length,e,i),C(I,r,t)},hashLength:t}}))}var w={name:"xxhash64",data:"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"};const B=new t;let E=null;const d=new ArrayBuffer(8);function y(A){return!Number.isInteger(A)||A<0||A>4294967295?new Error("Seed must be given as two valid 32-bit long unsigned integer (lo + high)."):null}function b(A,e,t){const n=new DataView(A);n.setUint32(0,e,!0),n.setUint32(4,t,!0)}A.createXXHash64=function(A=0,e=0){return y(A)?Promise.reject(y(A)):y(e)?Promise.reject(y(e)):c(w,8).then(t=>{const n=new ArrayBuffer(8);b(n,A,e),t.writeMemory(new Uint8Array(n)),t.init();const r={init:()=>(t.writeMemory(new Uint8Array(n)),t.init(),r),update:A=>(t.update(A),r),digest:A=>t.digest(A),blockSize:32,digestSize:8};return r})},A.xxhash64=function(A,t=0,n=0){if(y(t))return Promise.reject(y(t));if(y(n))return Promise.reject(y(n));if(null===E)return function(A,t,n){return e(this,void 0,void 0,(function*(){const e=yield A.lock(),r=yield c(t,n);return e(),r}))}(B,w,8).then(e=>(E=e,b(d,t,n),E.writeMemory(new Uint8Array(d)),E.calculate(A)));try{b(d,t,n),E.writeMemory(new Uint8Array(d));const e=E.calculate(A);return Promise.resolve(e)}catch(A){return Promise.reject(A)}},Object.defineProperty(A,"__esModule",{value:!0})}));
